# 重构
这是一个影片出租店用的程序，计算每一位顾客的消费金额并打印报表（statement），操作者告诉程序：顾客租了哪些影片、租期多长，程序便根据租赁时间和影片类型算出费用。
影片分为三类；普通片、儿童片和新片。除了计算费用，
还要为常客计算点数；
点数会随着"租片种类是否为新片"而有不同。


### 代码中存在的缺陷
 `Customer`类中的`statement()`较为庞大，做了很多与`Customer`不相干的事情，较为冗杂。



## 优化

### 函数封装
 - 将`statement()`函数中计算价格的代码提出
   - 代码更为清晰，函数更简短
   - 将each改名为`aRental`更加语义化
   - 封装后去除冗余的临时变量，使代码逻辑更清晰
 - 使用查询函数来做点数计算
   - 取代`totalAmount`和`frequentRentalPoints`两个临时变量，使得`statement()`函数更精简，做的事更专一
### 设计模式应用
 - 状态模式（State Pattern）
   - 意图：允许对象在内部状态发生改变时改变它的行为，对象看起来好像修改了它的类。
   - 主要解决：对象的行为依赖于它的状态（属性），并且可以根据它的状态改变而改变它的相关行为。
   - 何时使用：代码中包含大量与对象状态有关的条件语句。
   - 如何解决：将各种具体的状态类抽象出来。
   - 
### 类结构调整
 - 将积分计算转移到`Rental`中
 - 将常客计算逻辑转移到`Rental`中
 - 将各类型影片的价格计算调整到`Movie`类中
 - 影片类型可能多变，将`Movie`抽出，建立`Movie`子类，不同的影片有不同的计费方法。
